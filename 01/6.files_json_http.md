# 🌐 5-kun: Fayllar, JSON va HTTP

---

### 1. Fayl bilan ishlash — “os” va “io/ioutil”

Python’da siz `open("file.txt")` deysiz, Go’da esa:

```go
package main

import (
    "fmt"
    "os"
)

func main() {
    data, err := os.ReadFile("data.txt")
    if err != nil {
        fmt.Println("Xato:", err)
        return
    }
    fmt.Println("Fayl tarkibi:", string(data))
}
```

Yozish:

```go
err := os.WriteFile("output.txt", []byte("Go juda tez!"), 0644)
if err != nil {
    fmt.Println("Yozishda xato:", err)
}
```

**Python bilan farqi:**
Go’da `with open()` yo‘q — siz xotira va fayl oqimini **o‘zingiz boshqarasiz**, bu esa tezlikni oshiradi.

---

### 2. JSON bilan ishlash — `encoding/json`

JSON Go’da **struct** bilan bog‘liq.
Masalan, Django’da siz `serializer` orqali ma’lumotni JSON’ga o‘tkazasiz, Go’da esa bu `json.Marshal()` va `json.Unmarshal()` yordamida amalga oshadi.

```go
package main

import (
    "encoding/json"
    "fmt"
)

type User struct {
    Name string `json:"name"`
    Age  int    `json:"age"`
}

func main() {
    u := User{Name: "Tohir", Age: 25}

    // Struct -> JSON
    jsonData, _ := json.Marshal(u)
    fmt.Println(string(jsonData))

    // JSON -> Struct
    var newUser User
    json.Unmarshal(jsonData, &newUser)
    fmt.Println(newUser.Name, newUser.Age)
}
```

Chiqaradi:

```
{"name":"Tohir","age":25}
Tohir 25
```

**Teglar (`json:"name"`)** Python’dagi serializer field mapping’iga o‘xshaydi.

---

### 3. HTTP mijoz (client) — tashqi API’ga so‘rov yuborish

Go’da `net/http` kutubxonasi bilan har qanday API’ga request yuborish mumkin.

```go
package main

import (
    "fmt"
    "io"
    "net/http"
)

func main() {
    resp, err := http.Get("https://api.github.com")
    if err != nil {
        fmt.Println("So‘rovda xato:", err)
        return
    }
    defer resp.Body.Close()

    body, _ := io.ReadAll(resp.Body)
    fmt.Println(string(body[:300])) // faqat bir qismini chiqaramiz
}
```

**Farqi:** Go’da siz `requests` kutubxonasiz ishlaysiz.
Standart kutubxona yetarli — bu Go’ning dizayn falsafasi: *“Boshqacha emas, toza.”*

---

### 4. HTTP server — mini API yozish

Bu joyda siz ilk **Go REST endpoint**ni yozasiz.

```go
package main

import (
    "fmt"
    "net/http"
)

func helloHandler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "Salom, bu Go serverdan javob!")
}

func main() {
    http.HandleFunc("/hello", helloHandler)
    fmt.Println("Server 8080-portda ishlamoqda...")
    http.ListenAndServe(":8080", nil)
}
```

chiqaradi:

```
Server 8080-portda ishlamoqda...
```

so‘ngra brauzerda:
👉 [http://localhost:8080/hello](http://localhost:8080/hello)
chiqadi:

```
Salom, bu Go serverdan javob!
```

---

### 🧠 Python bilan farqi:

* Django’da siz `urls.py` orqali `path()` qo‘shasiz, Go’da esa `http.HandleFunc`.
* Django `runserver` ishlatadi, Go esa to‘liq kompilyatsiyalangan web-serverni o‘zi ichida yaratadi (ya’ni `nginx`siz ham ishlaydi!).
* Shuning uchun Go’dagi API **engilroq va tezroq**.

---

### 5. JSON javob qaytarish

Django’da siz `JsonResponse(data)` ishlatasiz, Go’da esa `json.NewEncoder(w)`.

```go
func apiHandler(w http.ResponseWriter, r *http.Request) {
    data := map[string]string{"message": "Go dan salom!"}
    w.Header().Set("Content-Type", "application/json")
    json.NewEncoder(w).Encode(data)
}

func main() {
    http.HandleFunc("/api", apiHandler)
    http.ListenAndServe(":8080", nil)
}
```

Endi `/api` endpoint sizga quyidagicha javob beradi:

```json
{"message": "Go dan salom!"}
```

---

### 🧪 Amaliy mashq:

Loyiha yarating:

```
api_project/
 ├── main.go
 └── data.json
```

`data.json` ichida quyidagi JSON bo‘lsin:

```json
[
  {"name": "Ali", "age": 22},
  {"name": "Mahliyo", "age": 24}
]
```

`main.go`:

* JSON faylni o‘qisin,
* uni struct’ga parse qilsin,
* `/users` endpointda JSON formatda qaytarsin.

---

### 🎯 Yakun:

Bugun siz:

* Fayl o‘qish/yozish,
* JSON ma’lumotlarni serialize va deserialize qilish,
* HTTP so‘rov yuborish va server yaratish
  ko‘nikmalarini o‘rgandingiz.

Endi sizning qo‘lingizda **Go’da real API server** tuzish uchun barcha zarur elementlar bor.

